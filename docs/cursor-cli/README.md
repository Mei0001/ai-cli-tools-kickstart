# Cursor CLI

## 概要・特徴

Cursor CLIは、ターミナルから直接AIエージェントにアクセスし、コードの作成、レビュー、変更を行うための強力なツールです。対話型のターミナルUIを提供し、スクリプトやCIパイプライン向けの出力自動化にも対応しています。これにより、開発者は作業環境を離れることなく、効率的にコーディング支援を受けることができます。

### 主な特徴

#### 1. インタラクティブモード
- エージェントとの会話セッションを開始し、目標を伝えることができます
- 提案された変更を確認し、コマンドを承認できます
- 自然言語での指示に対応し、複雑なタスクを段階的に実行

#### 2. 非対話モード（Printモード）
- スクリプト、CIパイプライン、自動化などの非対話シナリオに対応
- 特定のプロンプトとモデルを指定して実行可能
- 出力形式を指定して結果を取得可能（テキスト形式など）

#### 3. セッション管理
- 以前の会話を再開し、複数回のやり取りにわたって文脈を維持
- チャット履歴の一覧表示や特定の会話への復帰が可能
- 継続的な作業の文脈を保持

#### 4. シェルモード
- 会話を離れずにCLIからシェルコマンドを直接実行可能
- 安全チェック付きで、結果が会話内に表示される
- 短時間で非対話型のコマンドに適している

#### 5. MCP（Model Context Protocol）サポート
- エージェントはMCPをサポートしており、拡張機能や統合のために使用可能
- CLIは`mcp.json`の設定ファイルを自動検出して反映
- IDEで設定したのと同じMCPサーバーとツールを有効化

#### 6. ルールシステム
- CLIエージェントはIDEと同じルールシステムに対応
- `.cursor/rules`ディレクトリにルールを作成して、エージェントにコンテキストとガイダンスを提供可能
- プロジェクトの異なる部分や特定のファイルタイプごとにエージェントの挙動をカスタマイズ可能

#### 7. 設定ファイルによるカスタマイズ
- `cli-config.json`ファイルを使用して設定を管理
- 全体設定とプロジェクトごとの設定をサポート
- エディタのVimモードの有効化や権限の設定などが可能

## インストール方法

### システム要件

Cursor CLIは以下の環境で動作します：

- **オペレーティングシステム**: 
  - macOS
  - Linux
  - Windows（WSL対応）

- **シェル**: Bash、Zsh、またはFishで最適に動作

- **ネットワーク**: 認証とAI処理にインターネット接続が必要

- **アカウント**: Cursorアカウントが必要（無料プランまたは有料プラン）

### インストール手順

1. **インストールコマンドの実行**

   以下のコマンドでCursor CLIをインストールできます：

   ```bash
   curl https://cursor.com/install -fsS | bash
   ```

   このコマンドは、システムに適した方法でCursor CLIをインストールします。

2. **認証**

   インストール後、Cursorアカウントでログインする必要があります。初回実行時に認証プロンプトが表示されます。

3. **動作確認**

   インストールが完了したら、以下のコマンドで動作確認ができます：

   ```bash
   cursor-agent --help
   ```

## 基本的な使い方

### 基本的なコマンド

Cursor CLIは、ターミナルで`cursor-agent`コマンドを実行することで起動します。

```bash
cursor-agent
```

### インタラクティブモード

#### 対話セッションの開始

```bash
# 対話セッションを開始
cursor-agent

# 初期プロンプトを指定して開始
cursor-agent "authモジュールをJWTトークンを用いるようにリファクタリングして"
```

#### 基本的なワークフロー

1. **タスクの説明**
   - 自然言語でやりたいことを説明します
   - 例：「認証モジュールをJWTトークンを用いるようにリファクタリングして」

2. **提案の確認**
   - エージェントが計画や変更を提案します
   - 必要に応じて承認または修正を指示します

3. **実行**
   - エージェントが自動的にコードを生成・変更します
   - 各ステップで確認を求められる場合があります

4. **レビュー**
   - 生成されたコードや変更を確認します
   - 必要に応じて追加の修正を依頼します

### 非対話モード（Printモード）

スクリプトやCIパイプラインなど、自動化シナリオで使用します。

```bash
# 特定のプロンプトとモデルで実行
cursor-agent -p "パフォーマンス問題を見つけて修正して" --model "gpt-5"

# レビューのためにgitの変更を含めて実行
cursor-agent -p "これらの変更にセキュリティ上の問題がないかレビューして" --output-format text
```

### セッション管理

#### チャット履歴の一覧表示

```bash
# これまでのチャットをすべて一覧表示
cursor-agent ls
```

#### 会話の再開

```bash
# 直近の会話を再開
cursor-agent resume

# 特定の会話を再開
cursor-agent --resume="chat-id-here"
```

### シェルモード

会話を離れずにCLIからシェルコマンドを直接実行できます。

```bash
# シェルモードでコマンドを実行
cursor-agent shell "ls -la"
```

シェルモードは安全チェック付きで、結果が会話内に表示されるため、短時間で非対話型のコマンドに適しています。

### 設定ファイルの使用

#### cli-config.json

`cli-config.json`ファイルを使用して、Cursor CLIの設定を行います。このファイルは、全体設定とプロジェクトごとの設定を管理するために使用されます。

設定例：

```json
{
  "vimMode": true,
  "permissions": {
    "read": true,
    "write": true,
    "execute": false
  }
}
```

#### .cursor/rules ディレクトリ

プロジェクトごとにルールを設定することで、エージェントの挙動をカスタマイズできます。

例：`.cursor/rules/api.md`

```markdown
# API開発ルール

- RESTful APIの原則に従う
- エラーハンドリングを必ず実装する
- すべてのエンドポイントにドキュメントを追加する
```

#### mcp.json

MCP（Model Context Protocol）の設定ファイル。IDEで設定したのと同じMCPサーバーとツールをCLIでも有効化できます。

## 使用例・デモ

### 例1: コードのリファクタリング

```bash
cursor-agent "authモジュールをJWTトークンを用いるようにリファクタリングして"
```

エージェントは以下を実行します：
- 既存の認証コードの分析
- JWTトークン実装への変更計画の提示
- コードの変更とテストの実行
- 変更内容の説明

### 例2: パフォーマンス問題の特定と修正

```bash
cursor-agent -p "パフォーマンス問題を見つけて修正して" --model "gpt-5"
```

エージェントは以下を実行します：
- コードベースの分析
- パフォーマンスボトルネックの特定
- 最適化の提案と実装
- 改善結果の報告

### 例3: セキュリティレビュー

```bash
cursor-agent -p "これらの変更にセキュリティ上の問題がないかレビューして" --output-format text
```

エージェントは以下を実行します：
- Gitの変更内容の確認
- セキュリティ脆弱性の検出
- 問題点のレポート生成
- 修正提案の提示

### 例4: 継続的な作業の文脈保持

```bash
# 最初のセッション
cursor-agent "ユーザー認証機能を実装して"

# 作業を中断して後で再開
cursor-agent resume

# または特定の会話を再開
cursor-agent --resume="chat-id-here"
```

以前の会話の文脈を保持しながら、継続的な作業が可能です。

### 例5: CIパイプラインでの自動化

CIパイプラインでコードレビューを自動化する例：

```bash
#!/bin/bash
# CIスクリプトの例

cursor-agent -p "プルリクエストの変更をレビューして、問題があれば報告して" \
  --output-format text \
  --model "gpt-5" > review_report.txt
```

## セキュリティと注意事項

### セキュリティ機能

Cursor CLIは現在ベータ版であり、セキュリティ保護は進化の途上にあります。以下の点に注意してください：

- **エージェントの権限**: エージェントは、ユーザーが承認したシェルコマンドを実行できます
- **ファイル操作**: ファイルの読み取り・変更・削除が可能です
- **信頼できる環境**: 信頼できる環境でのみ使用することを推奨します

### 使用上の注意

- **ベータ版**: Cursor CLIは現在ベータ版のため、本番環境での使用は慎重に検討してください
- **承認プロセス**: エージェントが実行するコマンドは必ず確認してから承認してください
- **機密情報**: 機密情報を含むコードを扱う場合は、セキュリティポリシーを確認してください
- **バックアップ**: 重要な変更を行う前に、コードのバックアップを取ることを推奨します

## プランと料金

Cursor CLIは、Cursor IDEのアカウントで利用できます。Cursor IDEのプランは以下の通りです：

### 無料プラン

- 基本的な機能が利用可能
- 月間のリクエスト数に制限がある場合があります

### Proプラン

- **料金**: 月額20ドル
- より多くのリクエストと高度な機能にアクセス可能
- 優先サポート

### Businessプラン

- **料金**: 月額40ドル（年払いの場合）
- チーム向けの機能
- より高度なセキュリティ機能

### Enterpriseプラン

- **料金**: 営業担当者にお問い合わせください
- カスタム機能と専用サポート

詳細な料金情報や最新のプランについては、[Cursor公式サイト](https://cursor.com)を参照してください。

## 制限事項と注意点

### 現在の制限事項

- **ベータ版**: Cursor CLIは現在ベータ版のため、機能や仕様が変更される可能性があります
- **セキュリティ**: セキュリティ保護は進化の途上にあり、定期的に更新されています
- **パフォーマンス**: 大規模なコードベースでは、処理に時間がかかる場合があります

### 推奨事項

- **テスト環境**: まずはテスト環境で試してみることを推奨します
- **段階的な導入**: 重要なプロジェクトでは、段階的に導入することを推奨します
- **フィードバック**: 問題や改善提案があれば、Cursorチームにフィードバックを送信してください

## 参考資料

### 公式ドキュメント

- [Cursor CLI 概要](https://docs.cursor.com/ja/cli/overview)
- [Cursor CLI インストール](https://docs.cursor.com/ja/cli/installation)
- [Cursor CLI 使用方法](https://docs.cursor.com/ja/cli/using)
- [Cursor CLI シェルモード](https://docs.cursor.com/ja/cli/shell-mode)
- [Cursor CLI 設定リファレンス](https://docs.cursor.com/ja/cli/reference/configuration)

### 公式ブログ

- [Cursor CLI ブログ記事](https://cursor.com/ja/blog/cli)

### 公式サイト

- [Cursor公式サイト](https://cursor.com)
- [Cursor 料金プラン](https://cursor.com/pricing)

### コミュニティ

- [Cursor コミュニティ](https://cursor.com/community)

## まとめ

Cursor CLIは、開発者がターミナル環境でAIの力を活用し、効率的にコーディング作業を進めるための強力なツールです。インタラクティブモードと非対話モードの両方をサポートし、セッション管理、シェルモード、MCPサポート、ルールシステムなどの豊富な機能を備えています。

現在ベータ版ですが、継続的な改善が行われており、開発者のフィードバックを取り入れながら進化しています。信頼できる環境で適切に使用することで、開発プロセスの効率化と生産性向上が期待できます。

特に、CIパイプラインへの統合や自動化シナリオでの活用により、コードレビューやパフォーマンス最適化などの繰り返し作業を自動化できる可能性を秘めています。
